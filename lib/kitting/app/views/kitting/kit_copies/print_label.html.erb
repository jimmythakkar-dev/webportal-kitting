<!DOCTYPE HTML>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Print Label</title>
</head>
<style>
    /*Please input font-size of body,div stop 12 px from 16px*/
    /*Please input font-size of div.description stop 20 px from 30px*/
    body,div{
        margin: 0px; padding: 0px; font-size: 12px;
    }
    table, tr, td, th, tbody, thead, tfoot {
        margin: 0px; padding: 0px; page-break-inside: avoid; border: 1px solid #000000;
    }
    div.part_15px{
        text-align: center; margin: 0px;font-family: 'Arial';font-weight: bold;font-size: 15px;
    }
    div.part_13px{
        text-align: center; margin: 0px;font-family: 'Arial';font-weight: bold;font-size: 13px;
    }
    div.part_9px{
        text-align: center; margin: 0px;font-family: 'Arial';font-weight: bold;font-size: 9px;
    }
    span.qty{
        float: right;
    }
    div.cup_qty{
        margin: 0px; padding: 0px 5px;font-family: 'Arial';font-weight: bold;font-size: 11px;
    }
    .page{ display:block; clear:both; page-break-after:always;margin: 4% 2% 2% 2%; }
    .hr_page{ height: 175px; display:block; clear:both; page-break-after:always;margin: 0px 2px 0px 2px  }
    hr {  border: 0; border-top: 1px solid #000; }

    div.kit { padding-left: 5px; font-family: 'Arial'; font-size: large;font-size: 18px;  }
    div.bin_center { padding: 7px 5px 0px 5px;font-family: 'Arial';  }

    div.description{ padding: 0px 5px 5px 5px;font-weight: bold;text-align: center; font-size: 20px;}
    span.kit_small { float: right; padding-right: 5px; }
    span.bin_center { padding-left: 5px; }

    .page-break { padding-top: 100px;background-color: #0000FF; }
    .cup_description{ margin:auto; display:table; font-family: 'Arial';font-size: 10px;font-weight: bold;}
    .row_breaker{background-color: #eeeeee;}
    .cup_num{position: relative; font-size: 9px;padding:2px 3px; background-color: #1d3f62;color: #ffffff; vertical-align: top;}
    li.empty_cup{padding: 35px 0px;}

    .configurable_table_template{
        text-align: center;
        border: 1px solid #000;
        background: #A1B8CF;

    }

    .td_div{
        position: relative;
    }
    .configurable_table_template td{
        width: 200px;
        height: 160px;
        background-color: #fff;
    }
    .box-no
    {
        position: absolute;
        left: 0px;
        top: 0px;
        padding: 1px 3px;
        font-size: 11px;
    }
    .box-no-bottom{
        position: absolute;
        left: 0px;
        bottom: 0px;
        z-index: 1;
        padding: 1px 3px;
        font-size: 11px;
    }
    .part_block{
        display: block;
        text-align: right;
        font-size: 11px;
    }
    span.non-config-non-contract-part{
        position: relative;
        float: right;
        margin-top: -65px;
        margin-right: 10px;
        color: #ffffff;
    }
    .reference_text{
        text-align: center;
        font-size: 11px !important;
    }
    .small_reference_text{
        text-align: center;
        font-size: 9px !important;
    }
    .hr_part_number{
        text-align: left;
        padding: 2px;
        font-size: 11px !important;
    }
    .dashed_line_internal_label{
        border: 1px dashed #000000;
        width: 100%;
        position: relative;
        top: 1.75in;
    }
</style>


<%= wicked_pdf_stylesheet_link_tag 'jquery.gridster' -%>
<%#= wicked_pdf_stylesheet_link_tag 'demo' -%>
<style>
    .gridster{
        /*margin-top: -50px;*/
    }
    .gridster.gridster_screen_2{
        margin-top: 0px;
    }
    .gridster.gridster_screen_3_0{margin-top: 0px;}
    .gridster.gridster_screen_3_1{margin-top: 0px;}
    .gridster.gridster_screen_3_2{margin-top: 0px;}
    .gridster ul {
        background-color: #A1B8CF;
        width: 380px;
        height: 580px;
        overflow:hidden;
    }
    .gridster ul.small-template{
        float: left;
    }
    .gridster li{
        list-style-type: none;
    }
    .gridster.gridster_screen_2 ul {
        width: 780px;
        height: 520px !important;
    }
    .gridster.gridster_screen_2 ul li.gs-w{
        cursor:default;
    }

    .gridster.gridster_screen_3_0 ul {
        width: 1222px;
        height:640px !important;
    }
    .gridster.gridster_screen_3_1 ul {
        width: 258px;
        height: 250px !important;
    }
    .gridster.gridster_screen_3_2 ul {
        width: 258px;
        height: 250px !important;
    }


    /*.gridster.small_orange_kit {width:780px;}*/
    /*.gridster.small_orange_kit ul {width:780px; height:390px !important;}*/
    /*.gridster.small_orange_kit ul .gs-w {cursor:auto;}*/

    .gridster.gridster_screen_2 li{text-align:left;}
    .gridster.gridster_screen_3_0 li{text-align:left;}
    .gridster.gridster_screen_3_1 li{text-align:left;}
    .gridster.gridster_screen_3_2 li{text-align:left;}

    .gridster.gridster_screen_2{
        width: 780px;
    }
    .gridster_container {width:1265px; margin:0 auto; margin-bottom:100px;}

    .gridster.gridster_screen_3_0{
        width:1265px;
    }
    .gridster.gridster_screen_3_1{
        width: 300px;
        margin:0;  float:left;
    }
    .gridster.gridster_screen_3_2{
        width: 300px;
        margin:0; float:right;
    }
    .gridster .gs-w {
        background: #FFF;
        cursor: move;
    }

    .gridster.small_orange_kit .gs-w.d_none {display:none;}

    /***************** Small Oragnge Kit **************/
    .gridster.small_orange_kit {width:780px;}
    .gridster.small_orange_kit ul {width:780px; height:130px !important;}
    .gridster.small_orange_kit ul .gs-w {cursor:auto;}

    .small_orange_kit .s_arae {width:235px; height:100px; float:left; margin:0 10px 15px;}


    .kit_info_box {
        position: absolute;
        left: 450px;
        bottom: -100px;
    }
    .be_logo{
        float: left;
        width: 400px;
        position: relative;
    }
    .kit_info{
        float: left;
        width: 400px;
        position: relative;

    }
    .small_y_kit_info_box{
        width: 350px;
        position: relative;
        left: 8%;
        bottom: -10px;
    }
    .small_y_kit_info span{
        font-size: 14px!important;
    }
    .small_y_be_logo div{
        font-size: 14px!important;
    }
    .small_y_be_logo{
        position: relative;
    }
    .gridster.small_orange_kit ul li div.block_area img{
        width: 100% !important;
        height: 100px !important;
    }
    span.config-non-contract-part{
        font-size: 11px;
        position: absolute;
        right: 3px;
        bottom: 15px;
        text-align: right;
    }
    span.large_part_number{
        font-size: 10px;
    }
</style>
<%= wicked_pdf_javascript_include_tag "jquery" %>
<%= wicked_pdf_javascript_include_tag "jquery.gridster" %>
<%= wicked_pdf_javascript_include_tag "jquery.coords" %>
<%= wicked_pdf_javascript_include_tag "utils" %>
<%= wicked_pdf_javascript_include_tag "jquery.draggable" %>

<script type="text/javascript">
    jQuery.noConflict();
    var gridster;
    jQuery(function(){
        if(jQuery('#small_yellow_kit').length){
            gridster = jQuery(".gridster > ul").gridster({
                widget_margins: [5, 5],
                widget_base_dimensions: [130, 87]
            }).data('gridster').disable();
        }
        if(jQuery(".gridster_container #demo-1").length){

            gridster = jQuery("#demo-1 ul").gridster({
                namespace: '#demo-1',
                widget_margins: [3, 5],
                widget_base_dimensions: [120, 150]
            }).data('gridster').disable();
        }
        if(jQuery(".gridster_container #demo-2").length){
            gridster = jQuery("#demo-2 ul").gridster({
                namespace: '#demo-2',
                widget_margins: [5, 5],
                widget_base_dimensions : [140, 115]
            }).data('gridster').disable();
        }
        if(jQuery(".gridster_container #demo-3").length){
            gridster = jQuery("#demo-3 ul").gridster({
                namespace: '#demo-3',
                widget_margins: [5, 5],
                widget_base_dimensions: [140, 115]
            }).data('gridster').disable();
        }
        if(jQuery(".gridster.small_orange_kit #demo-1").length){
            gridster = jQuery("#demo-1 ul").gridster({
                namespace: '#demo-1',
                widget_margins: [5, 5],
                widget_base_dimensions: [120, 120]
            }).data('gridster').disable();
        }
        if(jQuery(".gridster.small_orange_kit #demo-2").length){
            gridster = jQuery("#demo-2 ul").gridster({
                namespace: '#demo-2',
                widget_margins: [5, 5],
                widget_base_dimensions: [120, 120]
            }).data('gridster').disable();
        }
        if(jQuery(".gridster.small_orange_kit #demo-3").length){
            gridster = jQuery("#demo-3 ul").gridster({
                namespace: '#demo-3',
                widget_margins: [5, 5],
                widget_base_dimensions: [120, 120]
            }).data('gridster').disable();
        }
    });
</script>
<body>
<% if params[:commit] == 'Print Internal Label'%>
    <% @cups.where(:commit_status => true,:status => true).order("id asc").sort_by {|cup| cup.cup_number.to_i }.each_with_index do |cup,index| %>
        <% if @kit_copy.kit.kit_media_type.kit_type == "configurable" || @current_kit_type == "configurable" %>
            <% if params[:cup_ids] %>
                <% params[:cup_ids].each do |select_id| %>
                    <% if cup.id == select_id.to_i %>
                        <%= render 'print_internal_labels', cup: cup, kit_type: @current_kit_type || @kit_copy.kit.kit_media_type.kit_type, label_type: params[:internal_label_type]  %>
                    <%end%>
                <%end%>
            <%else%>
                <%= render 'print_internal_labels', cup: cup, kit_type: @current_kit_type || @kit_copy.kit.kit_media_type.kit_type, label_type: params[:internal_label_type]  %>
            <%end%>
        <% else %>
            <% index = index + 1 %>
            <% if params[:cup_ids] %>
                <% params[:cup_ids].each do |select_id| %>
                    <% if cup.id == select_id.to_i %>
                        <%= render 'print_internal_labels', cup: cup, index: index, kit_type:  @current_kit_type || @kit_copy.kit.kit_media_type.kit_type, label_type: params[:internal_label_type]  %>
                    <%end%>
                <%end%>
            <%else%>
                <%= render 'print_internal_labels', cup: cup, index: index, kit_type: @current_kit_type || @kit_copy.kit.kit_media_type.kit_type, label_type: params[:internal_label_type]  %>
            <%end%>
        <% end %>
    <%end%>
<% elsif params[:commit] == 'Print All Internal Label' %>
    <% @cups.where(:commit_status => true).order("id asc").each_with_index do |cup,index|  %>
        <% if @child_kit_ids.index(cup.kit_id) %>
            <% box_number = @child_kit_ids.index(cup.kit_id) + 1 %>
        <% end %>
        <% if session[:copy_cup_ids] %>
            <% session[:copy_cup_ids].each do |select_id| %>
                <% if cup.id == select_id.to_i %>
                    <%= render 'kitting/kit_copies/print_internal_labels', cup: cup, kit_type: 'multi-media-type', label_type: params[:all_internal_label_type], box_number: box_number  %>
                <%end%>
            <%end%>
        <%else%>
            <%= render 'kitting/kit_copies/print_internal_labels', cup: cup, kit_type: 'multi-media-type', label_type: params[:all_internal_label_type], box_number: box_number  %>
        <%end%>
    <% end %>

<% elsif params[:commit] == 'Print External Label' || params[:commit] == 'Print All External Label' %>
    <% kit_version_number = @kit_copy.kit_version_number.upcase %>
    <% generate_barcode_for_all_in_one(kit_version_number) %>
    <% generate_barcode_for_all_in_one(@label_print_details["scancodeList"].join()) if @label_print_details["scancodeList"].join().present? %>
    <% if @kit_copy.kit.kit_media_type.kit_type == "multi-media-type" && params[:commit] == 'Print All External Label'%>
        <% @multi_media_kits.each_with_index do |kit, i| %>
            <%= "
  <div style = 'display:block; clear:both;text-align:center; padding : 15px 0px 0px 0px'>#{pdf_image_tag('/'+APP_CONFIG['kitting_barcode_path']+kit_version_number.split("").map(&:ord).join("")+'.png' )}</div>
  <div class='page'>
  <div class='kit' style = 'text-align:center;'><strong>#{kit_version_number}</strong></div>

  <span class='bin_center'>Area : #{@label_print_details["areaList"].join()}</span><span class='kit_small'>Bin Center :  #{@label_print_details["binCenter"]}</span>
  <br>

  <div style=' background-color:black;float:right; padding:3px 10px; font-weight:bold; margin-top:5px; font-size:15px; color:white'>KLX</div>
  <div style = 'float:right; text-align:center; width:70%;padding : 5px 0px'>#{pdf_image_tag('/'+APP_CONFIG['kitting_barcode_path']+@label_print_details["scancodeList"].join().split("").map(&:ord).join("")+'.png' ) if @label_print_details["scancodeList"].join().present? }</div>

  <div class='kit' style = 'clear:both;text-align:center;font-size:10px;'><strong>#{@label_print_details["scancodeList"].join()}</strong></div>
  <div class='kit' style = 'text-align:center;font-size:18px;'><strong>#{truncate(@kit_copy.kit.description, :length => 25, :separator => '',:omission=>' ')}</strong></div>
  <div class='bin_center' style = 'float: left;'><strong>Date:&nbsp;&nbsp;#{Time.now.strftime("%m/%d/%Y")}</strong></div>
  <div style='float:right;margin-top:5px;'>Box - #{i + 1} of #{@mmt_size}</div><div style='clear:both'></div></div>".html_safe %>
        <% end %>
    <% else %>
        <%= "
  <div style = 'display:block; clear:both;text-align:center; padding : 15px 0px 0px 0px'>#{pdf_image_tag('/'+APP_CONFIG['kitting_barcode_path']+kit_version_number.split("").map(&:ord).join("")+'.png' )}</div>
  <div class='page'>
  <div class='kit' style = 'text-align:center;'><strong>#{kit_version_number}</strong></div>

  <span class='bin_center'>Area : #{@label_print_details["areaList"].join()}</span><span class='kit_small'>Bin Center :  #{@label_print_details["binCenter"]}</span>
  <br>

  <div style=' background-color:black;float:right; padding:3px 10px; font-weight:bold; margin-top:5px; font-size:15px; color:white'>KLX</div>
  <div style = 'float:right; text-align:center; width:70%;padding : 5px 0px'>#{pdf_image_tag('/'+APP_CONFIG['kitting_barcode_path']+@label_print_details["scancodeList"].join().split("").map(&:ord).join("")+'.png' ) if @label_print_details["scancodeList"].join().present? }</div>

  <div class='kit' style = 'clear:both;text-align:center;font-size:10px;'><strong>#{@label_print_details["scancodeList"].join()}</strong></div>
  <div class='kit' style = 'text-align:center;font-size:18px;'><strong>#{truncate(@kit_copy.kit.description, :length => 25, :separator => '',:omission=>' ')}</strong></div>
  <div class='bin_center' style = 'float: left;'><strong>Date:&nbsp;&nbsp;#{Time.now.strftime("%m/%d/%Y")}</strong></div>
  <div style='float:right;margin-top:5px;'>#{@kit_copy.kit.kit_media_type.kit_type == "multi-media-type" && params[:box_number] ? "Box - "+ params[:box_number] +" of #{@mmt_size}" : ""}</div><div style='clear:both'></div></div>".html_safe %>
    <% end %>

<% else %>
    <% if @kit.try(:kit_media_type).try(:kit_type) == "binder"  %>
        <table style= "width: 40%; text-align: center;"  cellspacing='0' cellpadding='0'>
          <% @kit.cups.where(:commit_status => true,:status => true).order(:cup_number).each_with_index do |cup,index| %>
          <% if cup.cup_parts.present? %>
            <% if cup.cup_parts.first.status && cup.cup_parts.first.commit_status %>
              <tr>
                <td>
                  <div style="width: 100%; border-bottom: 1px dashed #000000;">
                    <strong><%=  cup.ref1%><br/><%=  cup.ref2%><br/><%=  cup.ref3%></strong>
                    &nbsp;</div>
                  <ul style ="list-style-type:none;padding-left: 0px;">
                    <%= raw get_parts_for_print_label(cup).join('') if cup %>
                  </ul>
                </td>
              </tr>
            <% end %>
          <% end %>
          <% end %>
        </table>

    <% else %>
        <%if @kit.kit_media_type.kit_type == "configurable" %>
            <%= @kit.kit_media_type.name != "Small Configurable TB" ? "<div class='gridster_container'>".html_safe : "<div class='gridster small_orange_kit' style='position:relative;'>".html_safe %>
            <% display_kit = create_group @kit.cups.where('commit_status = ? and status = ?', true,true).sort_by {|cup| cup.cup_number.to_i }, @kit.kit_media_type.name %>
            <% display_kit.each_with_index do |group,index| %>
                <div <%= add_class_and_id_to_gridster(@kit.kit_media_type.name,index) %> >
                  <ul <%= @kit.kit_media_type.name == "Small Removable Cup TB" ? "class='small-template'".html_safe : ""%>>
                    <% group.each_with_index do |cup,cup_index| %>
                        <% cup_dimension = cup.cup_dimension.split(",") %>
                        <li class="gs-w" id=<%= cup.id %> data-row=<%= cup_dimension[1].to_s %> data-col=<%= cup_dimension[0].to_s %> data-sizex=<%= cup_dimension[2].to_s %> data-sizey=<%= cup_dimension[3].to_s %> data-group=<%= cup_dimension[4].to_s %>>
                          <span class="box-no-bottom"><%= cup.cup_number %></span>
                          <div class="block_area">
                            <%= raw print_configurable_part_with_qty(cup).join('') %>
                          </div>
                        </li>
                    <% end %>
                  </ul>
                </div>
            <% end %>
            </div>
            <div class=<%= @kit.kit_media_type.name == "Small Removable Cup TB" || @kit.kit_media_type.name == "Small Configurable TB"  ? 'small_y_kit_info_box' : 'kit_info_box' %>>
              <div class=<%= @kit.kit_media_type.name == "Small Removable Cup TB" || @kit.kit_media_type.name == "Small Configurable TB" ? 'small_y_kit_info' : 'kit_info' %>>

                <span><b>Kit Copy Number : </b><%= @kit_copy.kit_version_number %></span><br/>
                <span><b>Kit Bincenter : </b><%= @kit_copy.kit.bincenter %></span><br/>
                <span><b>Kit Part Bincenter : </b><%= @kit_copy.kit.part_bincenter %></span><br/>
                <span><b>Kit Description : </b><%= @kit_copy.kit.description %></span><br/>
                <span><b> <%= @mmt_kit_index && @mmt_size ? "Box " +@mmt_kit_index.to_s+ " of " +@mmt_size.to_s : "" %></b></span>
              </div>
              <div class=<%= @kit.kit_media_type.name == "Small Removable Cup TB" || @kit.kit_media_type.name == "Small Configurable TB" ? 'small_y_be_logo' : 'be_logo' %>>
                <%= image_tag( Rails.root.join("app","assets","images","KLX_logo.jpg").to_s ,class: 'img-responsive', style: 'display:block; float:left;' ) %>
              </div>
              <div style="clear:left"></div>
            </div>

        <%else %>
            <% @cups = get_cups_layout @kit.cups.where(:commit_status => true), @kit.kit_media_type.compartment_layout %>
            <% index = 0 %>
            <% @cups.each_with_index do |row, row_index| %>
                <table  cellspacing="0" cellpadding="0" style="width: 100%;font-size: 9px;" >
                  <% width = row.blank?? 0 : (100/row.try(:count)).to_f %>
                  <tr style="page-break-inside: avoid !important;">
                    <% row.each_with_index do |value, col_index| %>
                        <td style="width: <%= 100/8 %>%; height: 155px;">
                          <div class="cup_num"><%= index + 1 %></div>
                          <div class="cup_description">
                            <div><%= value.ref1 ? "#{value.ref1}" : "&nbsp;".html_safe %></div>
                            <div><%= value.ref2 ? "#{value.ref2}" : "&nbsp;".html_safe %></div>
                            <div><%= value.ref3 ? "#{value.ref3}" : "&nbsp;".html_safe %></div>
                          </div>
                          <ul style ="height: 80px; list-style-type:none;padding-left: 0px;">
                            <%= raw get_parts_with_qty(value).join('') %>
                            <% if value.parts.count == 0 %>
                                <li class="empty_cup">&nbsp;</li>
                            <% end %>
                          </ul>
                        </td>
                        <% col_index += 1 %>
                        <% if col_index != 1 && col_index % 8 == 0 %>
                            <% if (((row.try(:count) > 8) && ((col_index/ 8) == 1)) || ((row.try(:count) > 16) && ((col_index/ 8) == 2 ))) %>
                                <td style="width: <%= width -3 %>%; vertical-align: bottom;">
                                  <%= image_tag( Rails.root.join("app","assets","images","arrow-return.png").to_s, height: '30px', width: '30px' ) %>
                                </td>
                            <% end %>
                            </tr>
                            <tr style="page-break-inside: avoid !important;" >
                        <% end %>
                        <% index += 1 %>
                    <% end %>
                    </tr>
                    </table>
            <% end %>
        <% end %>
        <% if @kit.kit_media_type.kit_type != "configurable" %>
            <div style="text-align: center;font-size: 16px; color: #1d3f62;margin-left: 300px;">
              <div style="float: left; width: 250px; margin-top: 35px;text-align: left;">
                <span><b>Kit Copy Number : </b><%= @kit_copy.kit_version_number %></span><br/>
                <span><b>Kit Bincenter : </b><%= @kit_copy.kit.bincenter %></span><br/>
                <span><b>Kit Part Bincenter : </b><%= @kit_copy.kit.part_bincenter %></span><br/>
                <span><b>Kit Description : </b><%= @kit_copy.kit.description %></span><br/>
                <span><b> <%= @mmt_kit_index && @mmt_size ? "Box " +@mmt_kit_index.to_s+ " of " +@mmt_size.to_s : "" %></b></span>
              </div>
              <div style="float: left; width: 400px; position: relative;">
                <%= image_tag( Rails.root.join("app","assets","images","KLX_logo.jpg").to_s , style: 'display:block; float:left;' ) %>

              </div>
              <div style="clear:left"></div>
            </div>
        <% end %>
    <% end %>
    <%# end %>
<% end %>
<% session.delete(:copy_cup_ids) %>
</body>
</html>